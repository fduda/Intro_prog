import ngrams as ng
import os

def build_language_model(language1_filename, language2_filename, k):

    final_list = []

    file1 = open(language1_filename, "r")
    text1 = file1.read()
    file1.close()
    final_list.append(ng.compute_ngrams_frequency(text1, k))

    file2 = open(language2_filename, "r")
    text2 = file2.read()
    file2.close()

    final_list.append(ng.compute_ngrams_frequency(text2, k))

    path_file1 = os.path.isfile(language1_filename)
    path_file2 = os.path.isfile(language2_filename)

    if path_file1 == False or path_file2 == False:
        return None

    if text1 == "" or text2 == "":
        return None  

    return final_list

def compute_ngram_distance(dict1, dict2):

    distance_between_ngram = []

    set_dict1 = set(key for key in dict1)
    set_dict2 = set(key for key in dict2)
    
    ngram_set = set_dict1.union(set_dict2)

    for element in ngram_set:
        if element in dict1 and element in dict2:
            distance_between_ngram.append(abs(dict1[element]-dict2[element]))
        elif element not in dict1:
            distance_between_ngram.append(dict2[element])
        elif element not in dict2:
            distance_between_ngram.append(dict1[element])
    
    distance = sum(distance_between_ngram)

    return distance

def classify_language(text_to_classify, list_of_dicts1, list_of_dicts2, threshold):
    
    # file1 = open(text_to_classify, "r")
    text = text_to_classify
    # file1.close() 
    n = 1

    text_ngrams = ng.compute_ngram_frequency(text, n)

    dist1 = compute_ngram_distance(list_of_dicts1[n-1], text_ngrams)
    dist2 = compute_ngram_distance(list_of_dicts2[n-1], text_ngrams)
    relative_distance = dist1/(dist1+dist2)

    while relative_distance < threshold:
        text_ngrams = ng.compute_ngram_frequency(text, n)
    
        dist1 = compute_ngram_distance(list_of_dicts1[n-1], text_ngrams)
        dist2 = compute_ngram_distance(list_of_dicts2[n-1], text_ngrams)
        relative_distance = dist1/(dist1+dist2)
        n += 1
        
    
    print(text_ngrams)
    print(dist1)
    print(dist2)
    print(relative_distance)


text = 'Statistics is a branch of mathematics dealing with the collection, analysis, interpretation, presentation, and \norganization of data. In applying statistics to a scientific, industrial, or social problem, it is conventional to \nbegin with a statistical population or a statistical model process to be studied. Populations can be diverse topics \nsuch as all people living in a country or every atom composing a crystal. Statistics deals with all aspects of data \nincluding the planning of data collection in terms of the design of surveys and experiments.\n\n'
list_of_dicts1 = [{'k': 0.015451174289245983, 'g': 0.029666254635352288, 'u': 0.009888751545117428, 'd': 0.059332509270704575, 'h': 0.02595797280593325, 'c': 0.009888751545117428, 'j': 0.01792336217552534, 'f': 0.00865265760197775, 'm': 0.037082818294190356, 'v': 0.019777503090234856, 'w': 0.012978986402966625, 'z': 0.013597033374536464, 'i': 0.05562422744128554, 'n': 0.10506798516687268, 'b': 0.02595797280593325, 'p': 0.023485784919653894, 'e': 0.173053152039555, 'o': 0.06674907292954264, 'l': 0.032756489493201486, 'y': 0.0012360939431396785, 't': 0.06056860321384425, 's': 0.032756489493201486, 'r': 0.0580964153275649, 'a': 0.10444993819530285}, {'jn': 0.004633204633204633, 'pk': 0.0007722007722007722, 'zu': 0.0007722007722007722, 'at': 0.009266409266409266, 'he': 0.011583011583011582, 'sp': 0.0007722007722007722, 'nn': 0.0007722007722007722, 'is': 0.003861003861003861, 'yn': 0.0007722007722007722, 'vl': 0.0023166023166023165, 'io': 0.0007722007722007722, 'vo': 0.0023166023166023165, 'oe': 0.004633204633204633, 'ro': 0.009266409266409266, 'ha': 0.0007722007722007722, 'ra': 0.003088803088803089, 'ht': 0.009266409266409266, 'da': 0.008494208494208495, 'ob': 0.006177606177606178, 'oi': 0.003088803088803089, 'eb': 0.0023166023166023165, 'an': 0.0416988416988417, 'ak': 0.0023166023166023165, 'ch': 0.010038610038610039, 'gg': 0.0007722007722007722, 'be': 0.0069498069498069494, 'rm': 0.003088803088803089, 'no': 0.0023166023166023165, 'le': 0.005405405405405406, 'rn': 0.0015444015444015444, 'tb': 0.0015444015444015444, 'nd': 0.0069498069498069494, 'nr': 0.0007722007722007722, 've': 0.003088803088803089, 'uw': 0.0007722007722007722, 'ko': 0.003861003861003861, 're': 0.006177606177606178, 'st': 0.0069498069498069494, 'og': 0.0023166023166023165, 'ri': 0.004633204633204633, 'do': 0.004633204633204633, 'lo': 0.0023166023166023165, 'lk': 0.0015444015444015444, 'pl': 0.006177606177606178, 'ds': 0.0007722007722007722, 'lv': 0.0007722007722007722, 'jz': 0.0007722007722007722, 'nk': 0.0015444015444015444, 'sa': 0.0007722007722007722, 'tw': 0.003088803088803089, 'ni': 0.0007722007722007722, 'hr': 0.0015444015444015444, 'ph': 0.006177606177606178, 'sy': 0.0007722007722007722, 'ec': 0.003861003861003861, 'ag': 0.0015444015444015444, 'te': 0.014671814671814672, 'en': 0.05328185328185328, 'la': 0.012355212355212355, 'bb': 0.003088803088803089, 'ml': 0.0015444015444015444, 'os': 0.008494208494208495, 'ek': 0.0023166023166023165, 'ka': 0.0007722007722007722, 'ct': 0.0015444015444015444, 'ep': 0.0007722007722007722, 'ir': 0.0015444015444015444, 'rl': 0.0007722007722007722, 'dt': 0.0015444015444015444, 'ze': 0.003861003861003861, 'fm': 0.0015444015444015444, 'ev': 0.003861003861003861, 'js': 0.0007722007722007722, 'ks': 0.0015444015444015444, 'my': 0.0007722007722007722, 'ok': 0.0015444015444015444, 'uu': 0.0023166023166023165, 'un': 0.0007722007722007722, 'il': 0.0007722007722007722, 'rd': 0.007722007722007722, 'li': 0.005405405405405406, 'hi': 0.0007722007722007722, 'mi': 0.0023166023166023165, 'ft': 0.0023166023166023165, 'gt': 0.004633204633204633, 'nc': 0.0007722007722007722, 'ur': 0.0023166023166023165, 'ho': 0.0069498069498069494, 'vr': 0.0007722007722007722, 'ut': 0.0007722007722007722, 'sl': 0.0023166023166023165, 'tj': 0.003088803088803089, 'ai': 0.0015444015444015444, 'ti': 0.008494208494208495, 'ga': 0.0023166023166023165, 'rg': 0.0015444015444015444, 'th': 0.0007722007722007722, 'wo': 0.0023166023166023165, 'md': 0.0007722007722007722, 'br': 0.0015444015444015444, 'dr': 0.0023166023166023165, 'ot': 0.0015444015444015444, 'on': 0.009266409266409266, 'tr': 0.0007722007722007722, 'ab': 0.0007722007722007722, 'ta': 0.0023166023166023165, 'nu': 0.0007722007722007722, 'au': 0.0007722007722007722, 'ez': 0.003861003861003861, 'ns': 0.0015444015444015444, 'se': 0.0007722007722007722, 'lj': 0.0007722007722007722, 'we': 0.009266409266409266, 'rk': 0.0007722007722007722, 'kk': 0.0015444015444015444, 'hu': 0.0007722007722007722, 'wa': 0.003861003861003861, 'et': 0.020077220077220077, 'ig': 0.005405405405405406, 'uk': 0.0007722007722007722, 'zw': 0.0007722007722007722, 'or': 0.009266409266409266, 'im': 0.003088803088803089, 'rs': 0.010038610038610039, 'ar': 0.022393822393822392, 'di': 0.004633204633204633, 'ba': 0.006177606177606178, 'du': 0.0023166023166023165, 'ls': 0.0007722007722007722, 'de': 0.044787644787644784, 'ge': 0.020077220077220077, 'am': 0.0007722007722007722, 'me': 0.008494208494208495, 'ic': 0.003861003861003861, 'of': 0.0015444015444015444, 'ts': 0.0023166023166023165, 'ei': 0.004633204633204633, 'ld': 0.0023166023166023165, 'bo': 0.005405405405405406, 'jo': 0.0007722007722007722, 'kr': 0.0023166023166023165, 'pt': 0.0015444015444015444, 'ne': 0.011583011583011582, 'jk': 0.0023166023166023165, 'pe': 0.004633204633204633, 'za': 0.0023166023166023165, 'ov': 0.0015444015444015444, 'lm': 0.0007722007722007722, 'ol': 0.0015444015444015444, 'zi': 0.0069498069498069494, 'nt': 0.003861003861003861, 'ap': 0.0023166023166023165, 'ui': 0.0023166023166023165, 'ee': 0.020077220077220077, 'af': 0.004633204633204633, 'td': 0.0007722007722007722, 'kt': 0.0015444015444015444, 'to': 0.003088803088803089, 'it': 0.0023166023166023165, 'lf': 0.0007722007722007722, 'es': 0.005405405405405406, 'in': 0.014671814671814672, 'om': 0.009266409266409266, 'od': 0.0015444015444015444, 'mo': 0.004633204633204633, 'wi': 0.0007722007722007722, 'em': 0.0023166023166023165, 'na': 0.008494208494208495, 'rv': 0.003088803088803089, 'ub': 0.0007722007722007722, 'eg': 0.003088803088803089, 'us': 0.0007722007722007722, 'jd': 0.003088803088803089, 'ng': 0.013127413127413128, 'ma': 0.021621621621621623, 'ja': 0.0007722007722007722, 'zo': 0.0023166023166023165, 'ul': 0.0007722007722007722, 'bu': 0.0007722007722007722, 'gr': 0.0015444015444015444, 'bj': 0.0015444015444015444, 'tu': 0.0015444015444015444, 'ef': 0.003861003861003861, 'al': 0.005405405405405406, 'lw': 0.0007722007722007722, 'oo': 0.008494208494208495, 'op': 0.011583011583011582, 'ie': 0.011583011583011582, 'rt': 0.0015444015444015444, 'ci': 0.0007722007722007722, 'aa': 0.03088803088803089, 'so': 0.0023166023166023165, 'ac': 0.003088803088803089, 'dz': 0.0007722007722007722, 'el': 0.013127413127413128, 'go': 0.0015444015444015444, 'ij': 0.016216216216216217, 'yt': 0.0007722007722007722, 'll': 0.0015444015444015444, 'ew': 0.0023166023166023165, 'ke': 0.004633204633204633, 'mt': 0.0015444015444015444, 'bi': 0.0069498069498069494, 'ed': 0.0023166023166023165, 'er': 0.020077220077220077, 'va': 0.016216216216216217, 'je': 0.004633204633204633, 'gi': 0.0023166023166023165, 'pp': 0.003088803088803089, 'as': 0.0007722007722007722, 'id': 0.005405405405405406}]
list_of_dicts2 = [{'x': 0.0011001100110011, 'g': 0.013751375137513752, 'u': 0.023652365236523653, 'd': 0.032453245324532455, 'h': 0.04950495049504951, 'c': 0.03355335533553355, 'j': 0.0027502750275027505, 'f': 0.0319031903190319, 'm': 0.0165016501650165, 'v': 0.007150715071507151, 'w': 0.012651265126512651, 'z': 0.00055005500550055, 'y': 0.01595159515951595, 'q': 0.0011001100110011, 'n': 0.06325632563256325, 'b': 0.010451045104510451, 'p': 0.023652365236523653, 'e': 0.15841584158415842, 'o': 0.07205720572057206, 'l': 0.0319031903190319, 't': 0.1111111111111111, 'i': 0.07535753575357536, 's': 0.08030803080308031, 'r': 0.06490649064906491, 'a': 0.066006600660066}, {'dd': 0.0006779661016949153, 'at': 0.029152542372881354, 'he': 0.03661016949152542, 'vi': 0.003389830508474576, 'od': 0.0006779661016949153, 'is': 0.008135593220338983, 'ca': 0.005423728813559322, 'ab': 0.002033898305084746, 'ix': 0.0006779661016949153, 'io': 0.007457627118644068, 're': 0.031864406779661014, 'ro': 0.0013559322033898306, 'ra': 0.005423728813559322, 'ye': 0.002033898305084746, 'tr': 0.0013559322033898306, 'co': 0.008813559322033898, 'si': 0.008813559322033898, 'oi': 0.0006779661016949153, 'an': 0.008135593220338983, 'bl': 0.0006779661016949153, 'ia': 0.002711864406779661, 'ch': 0.006101694915254237, 'be': 0.005423728813559322, 'ib': 0.0013559322033898306, 'rm': 0.002711864406779661, 'no': 0.003389830508474576, 'le': 0.010169491525423728, 'nd': 0.008135593220338983, 've': 0.005423728813559322, 'ri': 0.005423728813559322, 'st': 0.013559322033898305, 'ow': 0.003389830508474576, 'ol': 0.002711864406779661, 'do': 0.0006779661016949153, 'rv': 0.0006779661016949153, 'lo': 0.004067796610169492, 'am': 0.003389830508474576, 'lt': 0.0006779661016949153, 'ud': 0.0013559322033898306, 'sa': 0.0013559322033898306, 'tw': 0.002033898305084746, 'fa': 0.0006779661016949153, 'ni': 0.007457627118644068, 'gh': 0.0006779661016949153, 'ph': 0.0006779661016949153, 'pe': 0.002033898305084746, 'if': 0.002711864406779661, 'ec': 0.006101694915254237, 'te': 0.02576271186440678, 'pu': 0.0013559322033898306, 'la': 0.004067796610169492, 'ov': 0.0006779661016949153, 'os': 0.003389830508474576, 'ns': 0.004067796610169492, 'by': 0.002711864406779661, 'ct': 0.0047457627118644066, 'ep': 0.003389830508474576, 'wa': 0.0006779661016949153, 'mb': 0.003389830508474576, 'ze': 0.0006779661016949153, 'fl': 0.0013559322033898306, 'ev': 0.0013559322033898306, 'ff': 0.0047457627118644066, 'un': 0.007457627118644068, 'il': 0.002033898305084746, 'aj': 0.002033898305084746, 'rd': 0.0006779661016949153, 'qu': 0.0013559322033898306, 'li': 0.002033898305084746, 'hi': 0.003389830508474576, 'mi': 0.0006779661016949153, 'ft': 0.0006779661016949153, 'up': 0.002711864406779661, 'gt': 0.0006779661016949153, 'nc': 0.002033898305084746, 'ur': 0.003389830508474576, 'ho': 0.006779661016949152, 'ut': 0.002711864406779661, 'sl': 0.0013559322033898306, 'ly': 0.0047457627118644066, 'iz': 0.0006779661016949153, 'ua': 0.0006779661016949153, 'ti': 0.01966101694915254, 'ga': 0.0013559322033898306, 'sh': 0.0013559322033898306, 'th': 0.04135593220338983, 'dg': 0.0006779661016949153, 'ip': 0.0006779661016949153, 'gu': 0.0006779661016949153, 'dr': 0.0006779661016949153, 'on': 0.016271186440677966, 'da': 0.0006779661016949153, 'ac': 0.002711864406779661, 'iq': 0.0006779661016949153, 'dv': 0.0006779661016949153, 'dy': 0.0006779661016949153, 'oc': 0.0006779661016949153, 'xe': 0.0006779661016949153, 'mo': 0.002711864406779661, 'ad': 0.002711864406779661, 'ss': 0.002711864406779661, 'se': 0.02576271186440678, 'im': 0.0006779661016949153, 'we': 0.003389830508474576, 'eq': 0.0006779661016949153, 'hu': 0.0006779661016949153, 'ir': 0.002711864406779661, 'et': 0.003389830508474576, 'ex': 0.0006779661016949153, 'ty': 0.006101694915254237, 'ig': 0.0006779661016949153, 'or': 0.015593220338983051, 'cl': 0.0013559322033898306, 'gl': 0.0006779661016949153, 'ef': 0.0006779661016949153, 'rs': 0.009491525423728813, 'ar': 0.01152542372881356, 'fi': 0.007457627118644068, 'uc': 0.0006779661016949153, 'di': 0.002711864406779661, 'ou': 0.0047457627118644066, 'ba': 0.0006779661016949153, 'du': 0.002033898305084746, 'ls': 0.002711864406779661, 'ry': 0.0013559322033898306, 'pr': 0.01152542372881356, 'ge': 0.002033898305084746, 'ju': 0.0013559322033898306, 'me': 0.003389830508474576, 'ic': 0.013559322033898305, 'dm': 0.0006779661016949153, 'of': 0.02305084745762712, 'ms': 0.0013559322033898306, 'ea': 0.006779661016949152, 'ei': 0.003389830508474576, 'ld': 0.0006779661016949153, 'ce': 0.009491525423728813, 'bo': 0.0013559322033898306, 'fo': 0.002711864406779661, 'fr': 0.0006779661016949153, 'dl': 0.0006779661016949153, 'ue': 0.002033898305084746, 'gr': 0.0006779661016949153, 'ne': 0.002711864406779661, 'dc': 0.0006779661016949153, 'ag': 0.0013559322033898306, 'wo': 0.0013559322033898306, 'nt': 0.01423728813559322, 'sm': 0.0006779661016949153, 'sp': 0.0013559322033898306, 'ap': 0.0013559322033898306, 'ey': 0.002033898305084746, 'ee': 0.0013559322033898306, 'pi': 0.0013559322033898306, 'en': 0.02576271186440678, 'to': 0.01152542372881356, 'ha': 0.0047457627118644066, 'rl': 0.0013559322033898306, 'es': 0.02847457627118644, 'in': 0.01694915254237288, 'om': 0.004067796610169492, 'pp': 0.002033898305084746, 'it': 0.016271186440677966, 'wi': 0.0047457627118644066, 'em': 0.002033898305084746, 'na': 0.010169491525423728, 'al': 0.010169491525423728, 'eg': 0.004067796610169492, 'us': 0.005423728813559322, 'bs': 0.0006779661016949153, 'iv': 0.003389830508474576, 'ng': 0.008813559322033898, 'ma': 0.004067796610169492, 'su': 0.0006779661016949153, 'de': 0.010169491525423728, 'ul': 0.002033898305084746, 'lu': 0.0006779661016949153, 'wh': 0.0047457627118644066, 'tu': 0.004067796610169492, 'jo': 0.002033898305084746, 'ts': 0.004067796610169492, 'gg': 0.0006779661016949153, 'po': 0.007457627118644068, 'oo': 0.0006779661016949153, 'tl': 0.0006779661016949153, 'op': 0.002033898305084746, 'ie': 0.004067796610169492, 'rt': 0.0047457627118644066, 'ci': 0.002711864406779661, 'mp': 0.003389830508474576, 'nf': 0.0006779661016949153, 'ug': 0.0006779661016949153, 'el': 0.0047457627118644066, 'cu': 0.0013559322033898306, 'ot': 0.002711864406779661, 'll': 0.004067796610169492, 'ew': 0.0006779661016949153, 'cr': 0.0006779661016949153, 'pa': 0.002033898305084746, 'bi': 0.0013559322033898306, 'ed': 0.014915254237288136, 'er': 0.02305084745762712, 'fe': 0.002033898305084746, 'yh': 0.0006779661016949153, 'gi': 0.002711864406779661, 'tm': 0.0006779661016949153, 'as': 0.003389830508474576, 'ta': 0.010847457627118645, 'id': 0.007457627118644068, 'fu': 0.0006779661016949153}]
classify_language(text, list_of_dicts1, list_of_dicts2, threshold = 1)
